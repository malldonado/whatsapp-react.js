{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mathe\\\\OneDrive\\\\Desktop\\\\Projetos\\\\whatsapp-firebase\\\\src\\\\components\\\\ChatWindow.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport EmojiPicker from 'emoji-picker-react';\nimport './ChatWindow.css';\nimport MensageItem from './MensageItem';\nimport SearchIcon from '@material-ui/icons/Search';\nimport AttachFileIcon from '@material-ui/icons/AttachFile';\nimport MoreVertIcon from '@material-ui/icons/MoreVertSharp';\nimport InsertEmoticonIcon from '@material-ui/icons/InsertEmoticon';\nimport CloseIcon from '@material-ui/icons/Close';\nimport SendIcon from '@material-ui/icons/Send';\nimport MicIcon from '@material-ui/icons/Mic';\nimport Api from '../Api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default _s(_ref => {\n  _s();\n\n  let {\n    user,\n    data\n  } = _ref;\n  let recognition = null;\n  let SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n\n  if (SpeechRecognition !== undefined) {\n    recognition = new SpeechRecognition();\n  }\n\n  const body = useRef();\n  const [emojiOpen, setEmojiOpen] = useState(false);\n  const [text, setText] = useState('');\n  const [listening, setListening] = useState();\n  const [list, setList] = useState([{}]);\n  useEffect(() => {\n    setList([]);\n    let unsub = Api.onChatContent(data.chatId, setList);\n    return unsub;\n  }, [data.chatId]);\n  useEffect(() => {\n    if (body.current.scrollHeight > body.current.offsetHeight) {\n      body.current.scrollTop = body.current.scrollHeight - body.current.offsetHeight;\n    }\n  }, [list]);\n\n  const handleEmojiClick = (e, emojiObject) => {\n    setText(text + emojiObject.emoji);\n  };\n\n  const handleOpenEmoji = () => {\n    setSmojiOpen(true);\n  };\n\n  const handleCloseEmoji = () => {\n    setSmojiOpen(false);\n  };\n\n  const handleMicClick = () => {\n    if (recognition !== null) {\n      recognition.onstart = () => {\n        setListening(true);\n      };\n\n      recognition.onend = () => {\n        setListening(false);\n      };\n\n      recognition.onresult = e => {\n        setText(e.results[0][0].transcript);\n      };\n\n      recognition.start();\n    }\n  };\n\n  const handleInputKeyUp = e => {\n    if (e.keyCode == 13) {\n      handleSendClick();\n    }\n  };\n\n  const handleSendClick = () => {\n    if (text !== '') {\n      Api.sendMessage(data, user.id, 'text', text);\n      setText('');\n      setEmojiOpen(false);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chatWindow\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chatWindow--header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatWindow--headerinfo\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          className: \"chatWindow--avatar\",\n          src: data.image,\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chatWindow--name\",\n          children: data.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatWindow--headerbuttons\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chatWindow--btn\",\n          children: /*#__PURE__*/_jsxDEV(SearchIcon, {\n            style: {\n              color: '#919191'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chatWindow--btn\",\n          children: /*#__PURE__*/_jsxDEV(AttachFileIcon, {\n            style: {\n              color: '#919191'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chatWindow--btn\",\n          children: /*#__PURE__*/_jsxDEV(MoreVertIcon, {\n            style: {\n              color: '#919191'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: body,\n      className: \"chatWindow--body\",\n      children: list.map((item, key) => /*#__PURE__*/_jsxDEV(MensageItem, {\n        data: item,\n        user: user\n      }, key, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chatWindow--emojiarea\",\n      style: {\n        height: emojiOpen ? '200px' : '0'\n      },\n      children: /*#__PURE__*/_jsxDEV(EmojiPicker, {\n        onEmojiClick: handleEmojiClick\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chatWindow--footer\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatWindow--pre\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chatWindow--btn\",\n          onClick: handleCloseEmoji,\n          style: {\n            width: emojiOpen ? 40 : 0\n          },\n          children: /*#__PURE__*/_jsxDEV(CloseIcon, {\n            style: {\n              color: '#919191'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chatWindow--btn\",\n          onClick: handleOpenEmoji,\n          children: /*#__PURE__*/_jsxDEV(InsertEmoticonIcon, {\n            style: {\n              color: emojiOpen ? '#009688' : '#919191'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatWindow--inputarea\",\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"chatWindow--input\",\n          type: \"text\",\n          placeholder: \"Digite uma mensagem\",\n          value: text,\n          onChange: e => setText(e.target.value),\n          onKeyUp: handleInputKeyUp\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chatWindow--pos\",\n        children: [text === '' && /*#__PURE__*/_jsxDEV(\"div\", {\n          onClick: handleMicClick,\n          className: \"chatWindow--btn\",\n          children: /*#__PURE__*/_jsxDEV(MicIcon, {\n            style: {\n              color: listening ? '#126ece' : '#919191'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 15\n        }, this), text !== '' && /*#__PURE__*/_jsxDEV(\"div\", {\n          onClick: handleSendClick,\n          className: \"chatWindow--btn\",\n          children: /*#__PURE__*/_jsxDEV(SendIcon, {\n            style: {\n              color: '#919191'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 5\n  }, this);\n}, \"1kold/YDQbZEvFN3OIPxZRrA/8E=\");","map":{"version":3,"sources":["C:/Users/mathe/OneDrive/Desktop/Projetos/whatsapp-firebase/src/components/ChatWindow.js"],"names":["React","useState","useEffect","useRef","EmojiPicker","MensageItem","SearchIcon","AttachFileIcon","MoreVertIcon","InsertEmoticonIcon","CloseIcon","SendIcon","MicIcon","Api","user","data","recognition","SpeechRecognition","window","webkitSpeechRecognition","undefined","body","emojiOpen","setEmojiOpen","text","setText","listening","setListening","list","setList","unsub","onChatContent","chatId","current","scrollHeight","offsetHeight","scrollTop","handleEmojiClick","e","emojiObject","emoji","handleOpenEmoji","setSmojiOpen","handleCloseEmoji","handleMicClick","onstart","onend","onresult","results","transcript","start","handleInputKeyUp","keyCode","handleSendClick","sendMessage","id","image","title","color","map","item","key","height","width","target","value"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useRef} from 'react';\r\nimport EmojiPicker from 'emoji-picker-react';\r\nimport './ChatWindow.css';\r\nimport MensageItem from './MensageItem';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport AttachFileIcon from '@material-ui/icons/AttachFile';\r\nimport MoreVertIcon from '@material-ui/icons/MoreVertSharp';\r\nimport InsertEmoticonIcon from '@material-ui/icons/InsertEmoticon';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport MicIcon from '@material-ui/icons/Mic';\r\nimport Api from '../Api';\r\n\r\nexport default ({user, data}) => {\r\n\r\n  let recognition = null;\r\n\r\n  let SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\r\n\r\n  if(SpeechRecognition !== undefined) {\r\n    recognition = new SpeechRecognition();\r\n  }\r\n\r\n  const body = useRef();\r\n\r\n  const [emojiOpen, setEmojiOpen] = useState(false)\r\n  const [text, setText] = useState('');\r\n  const [listening, setListening] = useState();\r\n  const [list, setList] = useState([{}]);\r\n\r\n  useEffect(() => {\r\n      setList([]);\r\n      let unsub = Api.onChatContent(data.chatId, setList);\r\n      return unsub;\r\n  }, [data.chatId]);\r\n\r\n  useEffect(() => {\r\n    if(body.current.scrollHeight > body.current.offsetHeight) {\r\n      body.current.scrollTop = body.current.scrollHeight - body.current.offsetHeight;\r\n    }\r\n  }, [list]);\r\n\r\n  const handleEmojiClick = (e, emojiObject) => {\r\n    setText( text + emojiObject.emoji);\r\n  }\r\n\r\n  const handleOpenEmoji = () => {\r\n    setSmojiOpen(true);\r\n  }\r\n\r\n  const handleCloseEmoji = () => {\r\n    setSmojiOpen(false);\r\n  }\r\n\r\n  const handleMicClick = () => {\r\n    if(recognition !== null) {\r\n\r\n      recognition.onstart = () => {\r\n        setListening(true);\r\n      }\r\n\r\n      recognition.onend = () => {\r\n        setListening(false);\r\n      }\r\n\r\n      recognition.onresult = (e) => {\r\n        setText( e.results[0][0].transcript );\r\n      }\r\n\r\n      recognition.start();\r\n\r\n    }\r\n  }\r\n\r\n  const handleInputKeyUp = (e) => {\r\n    if(e.keyCode == 13) {\r\n      handleSendClick();\r\n    }\r\n  }\r\n\r\n  const handleSendClick = () => {\r\n    if(text !== '') {\r\n      Api.sendMessage(data, user.id, 'text', text);\r\n      setText('');\r\n      setEmojiOpen(false);\r\n    }\r\n  }\r\n  \r\n  return (\r\n    <div className=\"chatWindow\">\r\n        <div className=\"chatWindow--header\">\r\n          <div className=\"chatWindow--headerinfo\">\r\n            <img className='chatWindow--avatar' src={data.image} alt=\"\" />\r\n            <div className=\"chatWindow--name\">{data.title}</div>\r\n          </div>\r\n\r\n          <div className=\"chatWindow--headerbuttons\">\r\n            <div className=\"chatWindow--btn\">\r\n              <SearchIcon style={{color: '#919191'}} />\r\n            </div>\r\n            <div className=\"chatWindow--btn\">\r\n              <AttachFileIcon style={{color: '#919191'}} />\r\n            </div>\r\n            <div className=\"chatWindow--btn\">\r\n              <MoreVertIcon style={{color: '#919191'}} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div ref={body} className=\"chatWindow--body\">\r\n          {list.map((item, key)=>(\r\n            <MensageItem \r\n            key={key}\r\n            data={item}\r\n            user={user}\r\n            />\r\n          ))}\r\n        </div>\r\n\r\n        <div className='chatWindow--emojiarea' style={{height: emojiOpen ? '200px' : '0'}}>\r\n          <EmojiPicker onEmojiClick={handleEmojiClick}/>\r\n        </div>\r\n\r\n        <div className=\"chatWindow--footer\">\r\n          <div className=\"chatWindow--pre\">\r\n            <div className='chatWindow--btn' onClick={handleCloseEmoji} style={{width: emojiOpen ? 40 : 0}}>\r\n              <CloseIcon style={{color: '#919191'}} />\r\n            </div>\r\n            <div className='chatWindow--btn' onClick={handleOpenEmoji}>\r\n              <InsertEmoticonIcon style={{color: emojiOpen ? '#009688': '#919191'}} />\r\n            </div>\r\n          </div>\r\n          <div className=\"chatWindow--inputarea\">\r\n            <input className='chatWindow--input' type=\"text\" placeholder='Digite uma mensagem' value={text} onChange={e=>setText(e.target.value)} onKeyUp={handleInputKeyUp} />\r\n          </div>\r\n          <div className=\"chatWindow--pos\">\r\n\r\n            {text === '' && \r\n              <div onClick={handleMicClick} className='chatWindow--btn'>\r\n                <MicIcon style={{color: listening ? '#126ece' : '#919191'}} />\r\n              </div>\r\n            }\r\n            {text !== '' &&  \r\n              <div onClick={handleSendClick} className='chatWindow--btn'>\r\n                <SendIcon style={{color: '#919191'}} />\r\n              </div>\r\n            }\r\n\r\n          </div>\r\n        </div>\r\n    </div>\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}